<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Login CEFORSEG</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="d-flex align-items-center justify-content-center vh-100 bg-primary">

<div class="card p-4" style="width:350px;">
  <h4 class="text-center mb-3">Panel CEFORSEG</h4>

  <input id="usuario" class="form-control mb-2" placeholder="Usuario">
  <input id="password" type="password" class="form-control mb-3" placeholder="ContraseÃ±a">
  <button class="btn btn-primary w-100" onclick="login()">Ingresar</button>

  <div id="msg" class="text-danger mt-2 text-center"></div>
</div>

<script>
async function login(){
  const res = await fetch('/login',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      usuario:usuario.value,
      password:password.value
    })
  });
  const data = await res.json();
  if(!res.ok) return msg.innerText=data.mensaje;
  localStorage.setItem('token',data.token);
  localStorage.setItem('rol',data.rol);
  location.href='/dashboard';
}
</script>

</body>
</html>
